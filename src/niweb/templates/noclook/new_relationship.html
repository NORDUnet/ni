{% extends "base.html" %}

{% block title %}{{ block.super }} Create new relationship{% endblock %}

{% block content %}
    <div class="content">
        <h3>New relationship</h3>
        {% if message %}
            <p>{{ message }}</p>
        {% endif %}
        <form action="/new/{{ node_handle.node_type|slugify }}/{{ node_handle.handle_id }}/relationship/" method="post">
            {% csrf_token %}
            <table>
                <tr>
                    <th>Node</th><td>{{ node.type }} {{ node.name }}</td>
                </tr>
                <tr>
                    <th>Other node</th>
                    <td>
                        <select name="nodes">
                        {% for item in node_dicts|dictsort:"name" %}
                            <option value="{{ item.id }}">{{ item.type }} {{ item.name }}</option>
                        {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Direction</th>
                    <td>
                        <input type="radio" name="direction" value="out" />{{ node.name }} --> Other node<br />
                        <input type="radio" name="direction" value="in" />Other node --> {{ node.name }}<br />
                    </td>
                </tr>
                <tr>
                    <th>Relationship type</th>
                    <td>
                        <select name="types">
                            <option value="Connected_to">Connected to</option>
                            <option value="Depends_on">Depends on</option>
                            <option value="Has">Has</option>
                            <option value="Provides">Provides</option>
                            <option value="Responsible_for">Responsible for</option>
                            <option value="Uses">Uses</option>
                    </td>
                </tr>
            </table>
            <input type="submit" value="Create">
            <a href='{{ node_handle.get_absolute_url }}'><input type="button" value="Cancel"></a>
        </form>

<p><a id="toggle_debug" href="javascript:toggle_debug()">Toggle debug information</a></p>
    <div id="debug">
        <h3>Debug</h3>
        <h4>Node properties</h4>
        <table>
        {% for key,value in node.properties.items %}
            <tr>
                <td><b>{{key}}</b></td><td>{{value}}</td>
            </tr>
        {% endfor %}
        </table>
        <h4>Meta information</h4>
        <table>
            <tr>
                <td><b>handle_id:</b> </td><td>{{ node_handle.handle_id }}</td>
            </tr>
            <tr>
                <td><b>node_id:</b> </td><td>{{ node_handle.node_id }}</td>
            </tr>
            <tr>
                <td><b>node_name:</b> </td><td>{{ node_handle.node_name }}</td>
            </tr>
            <tr>
                <td><b>node_type:</b> </td><td>{{ node_handle.node_type }}</td>
            </tr>
            <tr>
                <td><b>node_meta_type:</b> </td><td>{{ node_handle.get_node_meta_type_display }}</td>
            </tr>
            <tr>
                <td><b>creator:</b> </td><td>{{ node_handle.creator }}</td>
            </tr>
            <tr>
                <td><b>created:</b> </td><td>{{ node_handle.created }}</td>
            </tr>
            <tr>
                <td><b>modified:</b> </td><td>{{ node_handle.modified }}</td>
            </tr>
        </table>
    </div>
{% endblock %}
