{% extends "base.html" %}

{% block title %}{{ block.super }} Detail{% endblock %}

{% block content %}
    <div class="content">
        <h2><a href="/{{ parent.node_type|slugify }}/{{ parent.handle_id }}/">{{ parent.name }}</a> {{ node.name }}</h2>


        <h3>Units</h3>
        <div class="section">
        {% if units %}
            <table>
                <th>Unit</th><th>Address</th><th>VLAN</th><th>Description</th>
                {% for unit in units %}
                <tr>
                    <td class="{% cycle 'align_top' 'align_top_grey' %}">{{ unit.unit }}</td>
                    <td class="{% cycle 'align_top' 'align_top_grey' %}">{% for address in unit.address %}{{ address }}<br />{% endfor %}</td>
                    <td class="{% cycle 'align_top' 'align_top_grey' %}">{{ unit.vlanid }}</td>
                    <td class="{% cycle 'align_top' 'align_top_grey' %}">{{ unit.description }}</td>
                </tr>
            {% endfor %}
            </table>
        {% else %}
            No units found.
        {% endif %}
        </div>

        <h3>Depends on this PIC</h3>
        <div class="section">
        {% if depending %}
            <table>
            <th>Service Address</th><th>VLAN</th><th>Service</th><th>Organisation Address<th>Organisation</th>
                {% for dep_group in depending %}
                    {% for item in dep_group %}
                        {% if forloop.counter0 == 0 %}
                            <tr>
                                <td class="{% cycle 'align_top' 'align_top_grey' %}">{{ item.ip_address }}<td class="{% cycle 'align_top' 'align_top_grey' %}">{{ item.vlan }}</td></td><td class="{% cycle 'align_top' 'align_top_grey' %}"><a href="/{{ item.start.node_type|slugify }}/{{ item.start.handle_id }}/">{{ item.start.name }}</a></td>
                        {% endif %}
                        {% if forloop.counter0 == 1 %}
                                <td class="{% cycle 'align_top' 'align_top_grey' %}">{{ item.ip_address }}</td><td class="{% cycle 'align_top' 'align_top_grey' %}"><a href="/{{ item.start.node_type|slugify }}/{{ item.start.handle_id }}/">{{ item.start.name }}</a></td>
                            </tr>
                        {% endif %}
                        {% if forloop.counter0 > 1 %}
                            <tr>
                                <td></td><td></td><td></td><td class="{% cycle 'align_top' 'align_top_grey' %}">{{ item.ip_address }}</td><td class="{% cycle 'align_top' 'align_top_grey' %}"><a href="/{{ item.start.node_type|slugify }}/{{ item.start.handle_id }}/">{{ item.start.name }}</a></td>
                            </tr>
                        {% endif %}
                    {% endfor %}
            {% endfor %}
            </table>
        {% else %}
            No services depending on this PIC found.
        {% endif %}
        </div>

        <p><a id="toggle_debug" href="javascript:toggle_debug()">Toggle debug information</a></p>
        <div id="debug">
            <h3>Debug</h3>
            <h4>Node properties</h4>
            <table>
            {% for key,value in node.properties.items %}
                <tr>
                    <td><b>{{key}}</b></td><td>{{value}}</td>
                </tr>
            {% endfor %}
            </table>

            <h4>Meta information</h4>
            <table>
                <tr>
                    <td><b>handle_id:</b> </td><td>{{ node_handle.handle_id }}</td>
                </tr>
                <tr>
                    <td><b>node_id:</b> </td><td>{{ node_handle.node_id }}</td>
                </tr>
                <tr>
                    <td><b>node_name:</b> </td><td>{{ node_handle.node_name }}</td>
                </tr>
                <tr>
                    <td><b>node_type:</b> </td><td>{{ node_handle.node_type }}</td>
                </tr>
                <tr>
                    <td><b>node_meta_type:</b> </td><td>{{ node_handle.get_node_meta_type_display }}</td>
                </tr>
                <tr>
                    <td><b>creator:</b> </td><td>{{ node_handle.creator }}</td>
                </tr>
                <tr>
                    <td><b>created:</b> </td><td>{{ node_handle.created }}</td>
                </tr>
                <tr>
                    <td><b>modified:</b> </td><td>{{ node_handle.modified }}</td>
                </tr>

            </table>
        </div>
     </div>
{% endblock %}

