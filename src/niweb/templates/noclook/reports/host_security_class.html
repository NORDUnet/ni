{% extends "base.html" %}

{% block title %}{{ block.super }} | Host reports | Host security class{% endblock %}

{% block js %}
    {{ block.super }}
    <script type="text/javascript">
        $(document).ready(
            function(){
                $("#hosts").tablesorter(
                    {
                        sortList: [[0,0], [1,0]],
                        headers:
                        {
                            3 : { sorter: "isoDate" }
                        },
                        widthFixed: true,
                        widgets: ['zebra']
                    });
            }
        );
    </script>
{% endblock %}

{% block content %}
    {{ block.super }}
    <h1>Host security class</h1>
    <hr>
    <ul class="nav nav-pills">
        {% if status == "all" %}
            <li class="active"><a href="/reports/hosts/host-security-class/all/">All</a></li>
        {% else %}
            <li class=""><a href="/reports/hosts/host-security-class/all/">All</a></li>
        {% endif %}
        {% if status == "classified" %}
            <li class="active"><a href="/reports/hosts/host-security-class/classified/">Classified</a></li>
        {% else %}
            <li class=""><a href="/reports/hosts/host-security-class/classified/">Classified</a></li>
        {% endif %}
        {% if status == "not-classified" %}
            <li class="active"><a href="/reports/hosts/host-security-class/not-classified/">Not Classified</a></li>
        {% else %}
            <li class=""><a href="/reports/hosts/host-security-class/not-classified/">Not Classified</a></li>
        {% endif %}
    </ul>
    {% if hosts %}
        <h3>Hosts: {{ num_of_hosts }}</h3>
        <p>Get as <a href="result.csv">CSV</a> or <a href="result.xls">Excel</a></p>
        <table id="hosts" class="tablesorter" cellspacing="1">
            <thead>
                <tr>
                    <th>Host</th><th>Class</th><th>Comment</th><th>Last seen</th>
                </tr>
            </thead>
            <tbody>
                {% load noclook_tags %}
                {% for item in hosts %}
                <tr>
                    <td><a href="{% noclook_node_to_url item.host %}">{{ item.host_name }}</a></td>
                    <td>{{ item.security_class|default:"" }}</td>
                    <td>{{ item.security_comment|default:"" }}</td>
                    <td>{% noclook_last_seen_to_dt item.last_seen as last_seen%}{{ last_seen|date:"D d M Y" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
{% endblock %}
